<div class="max-w-3xl mx-auto p-6">
  <div class="bg-white rounded-lg shadow-lg p-6">
    <h2 class="text-2xl font-bold mb-6"><%= @question.text %></h2>
    
    <% if session[:answers] && session[:answers][@question.id.to_s] %>
      <div class="mb-4 p-4 bg-green-100 border-2 border-green-500 rounded-lg">
        <strong>Votre réponse précédente :</strong> 
        <%= session[:answers][@question.id.to_s] %>
      </div>
    <% end %>
    
    <div id="answer-options">
      <% @question.answer_options.each do |option| %>
        <%= form_with url: answer_question_path(@question), 
                      method: :post, 
                      local: false,
                      data: { turbo: false } do |f| %>
          <%= hidden_field_tag :answer_code, option.code %>
          <%= hidden_field_tag :answer, option.text %>
          <button type="submit" 
                  class="w-full text-left p-4 mb-2 border-2 border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all"
                  onclick="markSelected(this); return true;">
            <%= option.text %>
          </button>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<script>
function markSelected(btn) {
  // Retirer la sélection précédente
  document.querySelectorAll('button').forEach(b => {
    b.classList.remove('bg-blue-500', 'text-white', 'border-blue-500');
  });
  // Marquer comme sélectionné
  btn.classList.add('bg-blue-500', 'text-white', 'border-blue-500');
  // Afficher visuellement
  setTimeout(() => {
    let display = document.getElementById('selection-display');
    if (!display) {
      display = document.createElement('div');
      display.id = 'selection-display';
      display.className = 'mt-4 p-4 bg-blue-100 border-2 border-blue-500 rounded-lg';
      btn.closest('.bg-white').appendChild(display);
    }
    display.innerHTML = '<strong>Sélection :</strong> ' + btn.innerText;
  }, 100);
}
</script>
