#!/usr/bin/env ruby

# Script pour mettre à jour les prix avec les tarifs Cogeli

prices = {
  # Raccordements
  "RA100150AP" => 779.97,
  "RA100150A90" => 815.11,
  "RA100150DP" => 569.17,
  "RA100150D90" => 720.04,
  "RA80130AP" => 654.29,
  "RA80130A90" => 683.57,
  "RA80130DP" => 477.01,
  "RA80130D90" => 602.76,
  "RA100AP" => 359.51,
  "RA130AP" => 361.67,
  "RA150AP" => 389.24,
  "RA180AP" => 493.01,
  "RA80AP" => 286.37,
  "RA100A90" => 344.57,
  "RA130A90" => 346.61,
  "RA150A90" => 370.45,
  "RA180A90" => 457.27,
  "RA80A90" => 272.57,
  "RA100AD" => 107.72,
  "RA130AD" => 107.89,
  "RA150AD" => 117.39,
  "RA180AD" => 141.93,
  "RA80AD" => 94.62,
  "RA100DP" => 268.99,
  "RA130DP" => 316.30,
  "RA150DP" => 337.78,
  "RA180DP" => 424.75,
  "RA80DP" => 236.99,
  "RA100D90" => 254.05,
  "RA130D90" => 301.24,
  "RA150D90" => 318.99,
  "RA180D90" => 389.01,
  "RA80D90" => 223.19,

  # Conduits concentrés
  "CFCC100150-1" => 355.14,
  "CFCC100150-2" => 541.36,
  "CFCC100150-3" => 873.31,
  "CFCC100150-4" => 965.90,
  "CFCC100150-5" => 1058.49,
  "CFCC100150-6" => 1151.08,
  "CFCC100150-7" => 1243.67,
  "CFCC100150-8" => 1336.26,
  "CFCC80130-1" => 239.03,
  "CFCC80130-2" => 401.49,
  "CFCC80130-3" => 665.20,
  "CFCC80130-4" => 742.36,
  "CFCC80130-5" => 819.52,
  "CFCC80130-6" => 896.68,
  "CFCC80130-7" => 973.84,
  "CFCC80130-8" => 1051.00,

  # Conduits DPE
  "CFDPE100-1" => 515.63,
  "CFDPE100-2" => 968.21,
  "CFDPE100-3" => 1241.37,
  "CFDPE100-4" => 1487.13,
  "CFDPE100-5" => 1760.29,
  "CFDPE100-6" => 1909.46,
  "CFDPE100-7" => 2182.62,
  "CFDPE100-8" => 2331.79,
  "CFDPE100-9" => 2604.95,
  "CFDPE130-1" => 574.50,
  "CFDPE130-2" => 1079.66,
  "CFDPE130-3" => 1379.05,
  "CFDPE130-4" => 1660.19,
  "CFDPE130-5" => 1959.58,
  "CFDPE130-6" => 2129.82,
  "CFDPE130-7" => 2429.21,
  "CFDPE130-8" => 2599.45,
  "CFDPE130-9" => 2898.84,
  "CFDPE150-1" => 611.29,
  "CFDPE150-2" => 1147.43,
  "CFDPE150-3" => 1455.63,
  "CFDPE150-4" => 1768.49,
  "CFDPE150-5" => 2076.69,
  "CFDPE150-6" => 2266.38,
  "CFDPE150-7" => 2574.58,
  "CFDPE150-8" => 2764.27,
  "CFDPE150-9" => 3072.47,
  "CFDPE80-1" => 364.58,
  "CFDPE80-2" => 565.31,
  "CFDPE80-3" => 687.64,
  "CFDPE80-4" => 997.37,
  "CFDPE80-5" => 1119.70,
  "CFDPE80-6" => 1242.03,
  "CFDPE80-7" => 1473.36,
  "CFDPE80-8" => 1595.69,
  "CFDPE80-9" => 1718.02,

  # Conduits DPI
  "CFDPI100-1" => 462.13,
  "CFDPI100-2" => 790.72,
  "CFDPI100-3" => 939.89,
  "CFDPI100-4" => 1256.14,
  "CFDPI100-5" => 1405.31,
  "CFDPI100-6" => 1554.48,
  "CFDPI100-7" => 1774.14,
  "CFDPI100-8" => 1923.31,
  "CFDPI100-9" => 2072.48,
  "CFDPI130-1" => 379.54,
  "CFDPI130-2" => 642.91,
  "CFDPI130-3" => 762.26,
  "CFDPI130-4" => 1027.01,
  "CFDPI130-5" => 1146.36,
  "CFDPI130-6" => 1265.71,
  "CFDPI130-7" => 1452.82,
  "CFDPI130-8" => 1572.17,
  "CFDPI130-9" => 1691.52,
  "CFDPI150-1" => 412.76,
  "CFDPI150-2" => 705.25,
  "CFDPI150-3" => 838.22,
  "CFDPI150-4" => 1125.17,
  "CFDPI150-5" => 1258.14,
  "CFDPI150-6" => 1391.11,
  "CFDPI150-7" => 1591.84,
  "CFDPI150-8" => 1724.81,
  "CFDPI150-9" => 1857.78,
  "CFDPI180-1" => 463.49,
  "CFDPI180-2" => 791.90,
  "CFDPI180-3" => 940.09,
  "CFDPI180-4" => 1258.39,
  "CFDPI180-5" => 1406.58,
  "CFDPI180-6" => 1554.77,
  "CFDPI180-7" => 1776.51,
  "CFDPI180-8" => 1924.70,
  "CFDPI180-9" => 2072.89,
  "CFDPI80-1" => 322.66,
  "CFDPI80-2" => 523.39,
  "CFDPI80-3" => 645.72,
  "CFDPI80-4" => 913.53,
  "CFDPI80-5" => 1035.86,
  "CFDPI80-6" => 1158.19,
  "CFDPI80-7" => 1347.60,
  "CFDPI80-8" => 1469.93,
  "CFDPI80-9" => 1592.26,

  # Dévoiements
  "DEVRAC100150" => 206.64,
  "DEVRAC80130" => 172.22,

  # Finitions hautes
  "FHT100MAC" => 250.92,
  "FHT130MAC" => 255.29,
  "FHT150MAC" => 262.51,
  "FHT180MAC" => 342.73,
  "FHT80MAC" => 159.37,
  "FHT100MET" => 1.00,
  "FHT130MET" => 1.00,
  "FHT150MET" => 1.00,
  "FHT80MET" => 1.00,
  "FHT100MACCC" => 255.25,
  "FHT100METCC" => 255.25,
  "FHDPE100" => 244.14,
  "FHDPE130" => 265.26,
  "FHDPE150" => 301.69,
  "FHDPE80" => 210.75,
  "FHCC100150ACIER" => 528.59,
  "FHCC100150PLAT" => 566.79,
  "FHCC100150ARDTP" => 611.17,
  "FHCC100150TUMEC" => 611.17,
  "FHCC80130ARDTP" => 578.67,
  "FHCC80130ACIER" => 477.01,
  "FHCC80130PLAT" => 515.21,
  "FHCC80130TUMEC" => 628.67,
  "FHDPI100ARDTP" => 595.27,
  "FHDPI100ACIER" => 512.69,
  "FHDPI100PLAT" => 550.89,
  "FHDPI100TUMEC" => 676.96,
  "FHDPI130ARDTP" => 674.92,
  "FHDPI130ACIER" => 622.72,
  "FHDPI130PLAT" => 664.79,
  "FHDPI130TUMEC" => 806.42,
  "FHDPI150ARDTP" => 764.36,
  "FHDPI150ACIER" => 787.80,
  "FHDPI150PLAT" => 719.39,
  "FHDPI150TUMEC" => 861.02,
  "FHDPI80ARDTP" => 550.91,
  "FHDPI80ACIER" => 468.33,
  "FHDPI80PLAT" => 506.53,
  "FHDPI80TUMEC" => 632.60,

  # Rehausses (options)
  "FHREH100" => 459.96,
  "FHREH130" => 492.67,
  "FHREH150" => 546.19,
  "FHREH80" => 409.51,

  # Liaisons
  "LI100150PT130" => 279.46,
  "LI80130PT100" => 263.51,
  "LI10015090T130" => 169.91,
  "LI8013090T100" => 224.60,
  "LI100PDPI100" => 178.20,
  "LI100PT100" => 179.15,
  "LI130PDPI130" => 196.96,
  "LI130PDPI150" => 276.39,
  "LI130PT130" => 193.64,
  "LI130PT150" => 301.17,
  "LI150PDPI150" => 218.80,
  "LI150PT130" => 314.68,
  "LI150PT150" => 211.23,
  "LI80PDPI80" => 145.01,
  "LI80PT100" => 222.56,
  "LI80PT80" => 1.00,
  "LI10090T100" => 206.75,
  "LI13090T130" => 163.85,
  "LI13090T150" => 236.48,
  "LI15090T130" => 218.74,
  "LI15090T150" => 149.30,
  "LI8090T100" => 242.45,
  "LI8090T80" => 150.30,
  "LI10090DPE100" => 584.14,
  "LI10090DPI100" => 540.85,
  "LI13090DPE130" => 639.98,
  "LI13090DPE150" => 762.91,
  "LI13090DPI130" => 588.24,
  "LI13090DPI150" => 762.91,
  "LI15090DPE150" => 705.32,
  "LI15090DPI150" => 648.38,
  "LI8090DPE80" => 145.01,
  "LI8090DPI80" => 503.64,

  # Conduits tubages
  "CFT100-10" => 357.00,
  "CFT100-15" => 535.50,
  "CFT100-6" => 214.20,
  "CFT100-8" => 285.60,
  "CFT130-10" => 435.00,
  "CFT130-15" => 651.00,
  "CFT130-6" => 261.00,
  "CFT130-8" => 348.00,
  "CFT150-10" => 507.00,
  "CFT150-15" => 760.50,
  "CFT150-6" => 304.20,
  "CFT150-8" => 396.60,
  "CFT180-10" => 831.39,
  "CFT180-15" => 877.50,
  "CFT180-6" => 351.00,
  "CFT180-8" => 468.00,
  "CFT80-10" => 267.00,
  "CFT80-15" => 400.50,
  "CFT80-6" => 267.00,
  "CFT80-8" => 213.60
}

updated_count = 0
not_found = []

prices.each do |code, price|
  kit = ProductKit.find_by(code: code)
  if kit
    kit.update!(price: price)
    updated_count += 1
    puts "✓ #{code}: #{price}€"
  else
    not_found << code
    puts "✗ #{code}: Kit non trouvé"
  end
end

puts "\n=== Résumé ==="
puts "Kits mis à jour: #{updated_count}"
puts "Kits non trouvés: #{not_found.size}"

if not_found.any?
  puts "\nKits non trouvés:"
  not_found.each { |code| puts "- #{code}" }
end