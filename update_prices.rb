#!/usr/bin/env ruby

# Script pour mettre à jour les prix avec les tarifs Cogeli

prices = {
  # Raccordements
  "RA100150AP" => 866.65,
  "RA100150A90" => 905.69,
  "RA100150DP" => 632.42,
  "RA100150D90" => 800.05,
  "RA80130AP" => 726.06,
  "RA80130A90" => 758.59,
  "RA80130DP" => 529.09,
  "RA80130D90" => 668.80,
  "RA100AP" => 399.44,
  "RA130AP" => 401.84,
  "RA150AP" => 432.48,
  "RA180AP" => 547.79,
  "RA80AP" => 318.20,
  "RA100A90" => 382.84,
  "RA130A90" => 385.10,
  "RA150A90" => 411.60,
  "RA180A90" => 508.07,
  "RA80A90" => 302.87,
  "RA100AD" => 119.69,
  "RA130AD" => 119.87,
  "RA150AD" => 130.43,
  "RA180AD" => 157.70,
  "RA80AD" => 105.14,
  "RA100DP" => 298.86,
  "RA130DP" => 351.43,
  "RA150DP" => 375.31,
  "RA180DP" => 471.95,
  "RA80DP" => 263.33,
  "RA100D90" => 282.26,
  "RA130D90" => 334.69,
  "RA150D90" => 354.43,
  "RA180D90" => 432.23,
  "RA80D90" => 248.00,

  # Conduits concentrés
  "CFCC100150-1" => 394.61,
  "CFCC100150-2" => 601.52,
  "CFCC100150-3" => 970.32,
  "CFCC100150-4" => 1073.20,
  "CFCC100150-5" => 1176.08,
  "CFCC100150-6" => 1278.96,
  "CFCC100150-7" => 1381.84,
  "CFCC100150-8" => 1484.72,
  "CFCC80130-1" => 265.60,
  "CFCC80130-2" => 446.10,
  "CFCC80130-3" => 739.10,
  "CFCC80130-4" => 824.83,
  "CFCC80130-5" => 910.56,
  "CFCC80130-6" => 996.29,
  "CFCC80130-7" => 1082.02,
  "CFCC80130-8" => 1167.75,

  # Conduits DPE
  "CFDPE100-1" => 572.93,
  "CFDPE100-2" => 1075.80,
  "CFDPE100-3" => 1379.31,
  "CFDPE100-4" => 1652.38,
  "CFDPE100-5" => 1955.89,
  "CFDPE100-6" => 2121.63,
  "CFDPE100-7" => 2425.14,
  "CFDPE100-8" => 2590.88,
  "CFDPE100-9" => 2894.39,
  "CFDPE130-1" => 638.33,
  "CFDPE130-2" => 1199.61,
  "CFDPE130-3" => 1532.26,
  "CFDPE130-4" => 1844.63,
  "CFDPE130-5" => 2177.28,
  "CFDPE130-6" => 2366.43,
  "CFDPE130-7" => 2699.08,
  "CFDPE130-8" => 2888.23,
  "CFDPE130-9" => 3220.88,
  "CFDPE150-1" => 679.21,
  "CFDPE150-2" => 1274.92,
  "CFDPE150-3" => 1617.36,
  "CFDPE150-4" => 1964.97,
  "CFDPE150-5" => 2307.41,
  "CFDPE150-6" => 2518.17,
  "CFDPE150-7" => 2860.61,
  "CFDPE150-8" => 3071.37,
  "CFDPE150-9" => 3413.81,
  "CFDPE80-1" => 405.08,
  "CFDPE80-2" => 628.11,
  "CFDPE80-3" => 764.03,
  "CFDPE80-4" => 1108.17,
  "CFDPE80-5" => 1244.09,
  "CFDPE80-6" => 1380.01,
  "CFDPE80-7" => 1637.04,
  "CFDPE80-8" => 1772.96,
  "CFDPE80-9" => 1908.88,

  # Conduits DPI
  "CFDPI100-1" => 513.48,
  "CFDPI100-2" => 878.58,
  "CFDPI100-3" => 1044.32,
  "CFDPI100-4" => 1395.71,
  "CFDPI100-5" => 1561.45,
  "CFDPI100-6" => 1727.19,
  "CFDPI100-7" => 1971.25,
  "CFDPI100-8" => 2136.99,
  "CFDPI100-9" => 2302.73,
  "CFDPI130-1" => 421.74,
  "CFDPI130-2" => 714.38,
  "CFDPI130-3" => 846.99,
  "CFDPI130-4" => 1141.16,
  "CFDPI130-5" => 1273.77,
  "CFDPI130-6" => 1406.38,
  "CFDPI130-7" => 1614.28,
  "CFDPI130-8" => 1746.89,
  "CFDPI130-9" => 1879.50,
  "CFDPI150-1" => 458.60,
  "CFDPI150-2" => 783.57,
  "CFDPI150-3" => 931.31,
  "CFDPI150-4" => 1250.13,
  "CFDPI150-5" => 1397.87,
  "CFDPI150-6" => 1545.61,
  "CFDPI150-7" => 1768.64,
  "CFDPI150-8" => 1916.38,
  "CFDPI150-9" => 2064.12,
  "CFDPI180-1" => 515.00,
  "CFDPI180-2" => 879.90,
  "CFDPI180-3" => 1044.56,
  "CFDPI180-4" => 1398.23,
  "CFDPI180-5" => 1562.89,
  "CFDPI180-6" => 1727.55,
  "CFDPI180-7" => 1973.93,
  "CFDPI180-8" => 2138.59,
  "CFDPI180-9" => 2303.25,
  "CFDPI80-1" => 358.50,
  "CFDPI80-2" => 581.53,
  "CFDPI80-3" => 717.45,
  "CFDPI80-4" => 1015.01,
  "CFDPI80-5" => 1150.93,
  "CFDPI80-6" => 1286.85,
  "CFDPI80-7" => 1497.30,
  "CFDPI80-8" => 1633.22,
  "CFDPI80-9" => 1769.14,

  # Dévoiements
  "DEVRAC100150" => 229.60,
  "DEVRAC80130" => 191.36,

  # Finitions hautes
  "FHT100MAC" => 278.80,
  "FHT130MAC" => 283.66,
  "FHT150MAC" => 291.68,
  "FHT180MAC" => 380.81,
  "FHT80MAC" => 177.08,
  "FHT100MET" => 1.00,
  "FHT130MET" => 1.00,
  "FHT150MET" => 1.00,
  "FHT80MET" => 1.00,
  "FHT100MACCC" => 283.61,
  "FHT100METCC" => 283.61,
  "FHDPE100" => 271.27,
  "FHDPE130" => 294.74,
  "FHDPE150" => 335.21,
  "FHDPE80" => 234.16,
  "FHCC100150ACIER" => 580.50,
  "FHCC100150PLAT" => 622.94,
  "FHCC100150ARDTP" => 672.26,
  "FHCC100150TUMEC" => 672.26,
  "FHCC80130ARDTP" => 636.15,
  "FHCC80130ACIER" => 523.19,
  "FHCC80130PLAT" => 565.63,
  "FHCC80130TUMEC" => 691.70,
  "FHDPI100ARDTP" => 661.30,
  "FHDPI100ACIER" => 569.54,
  "FHDPI100PLAT" => 611.98,
  "FHDPI100TUMEC" => 752.06,
  "FHDPI130ARDTP" => 744.09,
  "FHDPI130ACIER" => 686.09,
  "FHDPI130PLAT" => 732.83,
  "FHDPI130TUMEC" => 890.20,
  "FHDPI150ARDTP" => 842.86,
  "FHDPI150ACIER" => 868.92,
  "FHDPI150PLAT" => 792.90,
  "FHDPI150TUMEC" => 950.27,
  "FHDPI80ARDTP" => 612.01,
  "FHDPI80ACIER" => 520.25,
  "FHDPI80PLAT" => 562.69,
  "FHDPI80TUMEC" => 702.77,

  # Rehausses (options)
  "FHREH100" => 511.07,
  "FHREH130" => 547.41,
  "FHREH150" => 606.88,
  "FHREH80" => 455.01,

  # Liaisons
  "LI100150PT130" => 310.51,
  "LI80130PT100" => 292.80,
  "LI10015090T130" => 188.78,
  "LI8013090T100" => 249.56,
  "LI100PDPI100" => 198.00,
  "LI100PT100" => 199.06,
  "LI130PDPI130" => 218.85,
  "LI130PDPI150" => 307.09,
  "LI130PT130" => 215.16,
  "LI130PT150" => 334.64,
  "LI150PDPI150" => 243.11,
  "LI150PT130" => 349.64,
  "LI150PT150" => 234.70,
  "LI80PDPI80" => 161.12,
  "LI80PT100" => 247.29,
  "LI80PT80" => 1.00,
  "LI10090T100" => 229.72,
  "LI13090T130" => 182.05,
  "LI13090150" => 262.76,
  "LI15090T130" => 243.04,
  "LI15090T150" => 165.89,
  "LI8090T100" => 269.39,
  "LI8090T80" => 167.00,
  "LI10090DPE100" => 649.06,
  "LI10090DPI100" => 600.95,
  "LI13090DPE130" => 711.11,
  "LI13090DPE150" => 847.66,
  "LI13090DPI130" => 653.62,
  "LI13090DPI150" => 847.66,
  "LI15090DPE150" => 783.68,
  "LI15090DPI150" => 720.41,
  "LI8090DPE80" => 161.12,
  "LI8090DPI80" => 559.60,

  # Conduits tubages
  "CFT100-10" => 357.00,
  "CFT100-15" => 535.50,
  "CFT100-6" => 214.20,
  "CFT100-8" => 285.60,
  "CFT130-10" => 435.00,
  "CFT130-15" => 651.00,
  "CFT130-6" => 261.00,
  "CFT130-8" => 348.00,
  "CFT150-10" => 507.00,
  "CFT150-15" => 760.50,
  "CFT150-6" => 304.20,
  "CFT150-8" => 396.60,
  "CFT180-10" => 831.39,
  "CFT180-15" => 877.50,
  "CFT180-6" => 351.00,
  "CFT180-8" => 468.00,
  "CFT80-10" => 267.00,
  "CFT80-15" => 400.50,
  "CFT80-6" => 267.00,
  "CFT80-8" => 213.60
}

updated_count = 0
not_found = []

prices.each do |code, price|
  kit = ProductKit.find_by(code: code)
  if kit
    kit.update!(price: price)
    updated_count += 1
    puts "✓ #{code}: #{price}€"
  else
    not_found << code
    puts "✗ #{code}: Kit non trouvé"
  end
end

puts "\n=== Résumé ==="
puts "Kits mis à jour: #{updated_count}"
puts "Kits non trouvés: #{not_found.size}"

if not_found.any?
  puts "\nKits non trouvés:"
  not_found.each { |code| puts "- #{code}" }
end